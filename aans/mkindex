#!/bin/sh 
# module:         %M%
# version:        %I%
# last modify:    %E% %U%
#
# %W% %E% %U% %Y% %Q%, Volker Braun.
#
set -x
#
IDENT=`basename $0`
HTML_BASE=/NET/htdocs
VERSION=%I%
TITLE="Index of AANS AWW Server"
#-------------------------------
info() {
   echo "${IDENT} [info] $@" >&2
}
error() {
   echo "${IDENT} [errror] $@" >&2
}
warning() {
   echo "${IDENT} [warning] $@" >&2
}
# generate the HTML Header
#-------------------------
GEN_HEADER()
{
    cat << __HEADER__
	<HTML>
	<HEAD>
	<TITLE>$TITLE</TITLE>
	</HEAD>
	<BODY BGCOLOR="FFFFFF">
	<H1>$TITLE</H1>
	<HR>
__HEADER__	
}
# generate the HTML Footer
#-------------------------
GEN_FOOTER()
{
	<HR>
	<ADDRESS>Page generated by ${IDENT} V${VERSION} at `date` </ADDRESS>
	</BODY></HTML>
__FOOTER__	
}
# process the given directory for index files
#--------------------------------------------
PROCESS_DIRECTORY()
{
	if [ -f "$1/index.html" ]
	then
        	echo "<UL>"
        	HTML_PATH=`basename $1 ${HTML_BASE}`
        	echo "<LI><A HREF=\"/$HTML_PATH/index.html\">/$HTML_PATH/index.html\</A></LI>"
		
	DIRS=`ls -1 $1/*`
	for node in $NODES
        do
        	if [ $node = "index.html" ]
        	then
        		echo "<UL>"
        		echo "<LI><A HREF=\"$1/$node\">$1/$node</A></LI>
        	elif [ -d $node ]
        	then
        		PROCESS_DIRECTORY($1/$node)
        	else
        		echo "</UL>"
        	fi
       done
	
}
# MAIN
#-----
GEN_HEADER()
PROCESS_DIRECTORY(${HTML_BASE})
GEN_FOOTER()
exit 0
# EOF